<!DOCTYPE html>
<html>
<head>

    <style>
        #jsonFetcherContainer{
            margin: 50px;
        }
    </style>

</head>
<script>
    var form = document.forms.namedItem("myForm");
    form.addEventListener("submit", function (event) {
        console.log("Kapil: Submit pressed: " + Date.now());
        var file = document.getElementById("myFile").files[0];
        var data = new FormData(form);
        var req = new XMLHttpRequest();
        req.open("POST", "/upload", true);
        req.onload = function(resp){
            console.log(resp);
            if(req.status == 200 ){
                // console.log(req.response)
                console.log("Kapil: JSON Received: " + Date.now());
                document.getElementById("jsonDiv").value = req.response                
            }
        }
        req.send(data);
        event.preventDefault();
    }, false);


    var fetchJSONForm = document.forms.namedItem("jsonFetcherForm");
    fetchJSONForm.addEventListener("submit", function (event) {
        console.log("Fetch JSON pressed: " + Date.now());
        var data = new FormData(form);
        var req = new XMLHttpRequest();
        req.open("GET", "/download", true);
        req.onload = function(resp){
            console.log(resp);
            if(req.status == 200 ){
                // console.log(req.response)
                console.log("Kapil: JSON Received: " + Date.now());
                document.getElementById("jsonDiv").value = req.response
            }
        }
        req.send(data);
        event.preventDefault();
    }, false)

</script>

<body>

    <form id="myForm" name="myForm" enctype="multipart/form-data" method="post">
        <input type="file" id="myFile" name="myFile">
        <input id="mybutton" type="submit" name="submit" value = "GenerateJson">
    </form>
    <textarea id = "jsonDiv" height = "800px" width = "800px">
    </textarea>

    <div id="jsonFetcherContainer" >
        <form id="jsonFetcher" name="jsonFetcherForm" enctype="multipart/form-data" method="get">
            <label>Select the JSON name to be fetched: </label><br>
            <input type="radio" name="jsonType" value="node_string"> node_string<br>
            <input type="radio" name="jsonType" value="node_string_2"> node_string_2<br>
            <input type="radio" name="jsonType" value="package"> package<br>
            <input id="fetchJsonBtn" type="submit" name="Fetch JSON" value = "FetchJson">
        </form>

    </div>
</body>

</html>